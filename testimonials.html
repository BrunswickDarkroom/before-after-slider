<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Testimonials</title>

<style>

:root{
--bg:#121212;
--card:#151515;
--text:#f2f2f3;
--muted:rgba(242,242,243,.72);
--line:rgba(255,255,255,.10);
--shadow:0 14px 50px rgba(0,0,0,.55);
--radius:18px;
--fadeTo:#151515;
}

html,body{
height:100%;
margin:0;
background:var(--bg);
color:var(--text);
overflow:hidden;
}

*{box-sizing:border-box;}

body{
display:flex;
align-items:center;
justify-content:center;
padding:22px;
font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
}

.wrap{
width:min(1100px,100%);
}

/* TITLE */

.title{
font-size:20px;
font-weight:600;
margin-bottom:14px;
letter-spacing:.2px;
color:#ffffff;
}

/* VIEWPORT */

.viewport{
position:relative;
border-radius:var(--radius);
background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
border:1px solid var(--line);
box-shadow:var(--shadow);
overflow:hidden;
touch-action:pan-y;
}

/* TRACK */

.track{
display:flex;
gap:14px;
padding:16px;
will-change:transform;
transform:translate3d(0,0,0);
}

/* CARD */

.card{
background:var(--card);
border:1px solid var(--line);
border-radius:16px;
padding:18px 18px 16px;
position:relative;
flex:0 0 var(--cardW,520px);
min-width:0;
}

.stars{
font:700 14px/1 system-ui;
margin-bottom:10px;
}

/* QUOTE */

.quote{
position:relative;
font-size:16px;
line-height:1.45em;
margin:0 0 10px;

display:-webkit-box;
-webkit-box-orient:vertical;
-webkit-line-clamp:6;
overflow:hidden;
}

/* fade only when clamped */

.quote.clamped::after{
content:"";
position:absolute;
left:0;
right:0;
bottom:0;
height:28px;
background:linear-gradient(transparent,var(--fadeTo));
}

/* expanded */

.card.expanded .quote{
-webkit-line-clamp:unset;
overflow:visible;
}

.card.expanded .quote::after{
display:none;
}

/* READ MORE */

.readmore{
appearance:none;
border:0;
background:none;
padding:0;
margin-top:6px;

font-size:13px;
font-weight:700;
color:white;
cursor:pointer;

display:none;
opacity:.8;
}

.readmore:hover{
opacity:1;
text-decoration:underline;
}

/* META */

.meta{
display:flex;
justify-content:space-between;
margin-top:10px;
font-size:13px;
color:var(--muted);
}

.name{
color:white;
}

/* CONTROLS */

.controls{
position:absolute;
top:14px;
right:14px;
display:flex;
gap:10px;
z-index:5;
}

button.ctrl{
appearance:none;
border:1px solid var(--line);
background:rgba(255,255,255,.05);
color:white;

width:44px;
height:44px;

border-radius:999px;
cursor:pointer;

font-size:18px;
font-weight:700;
}

button.ctrl:hover{
background:rgba(255,255,255,.1);
}

/* DOTS */

.dots{
display:flex;
gap:8px;
justify-content:center;
padding-top:12px;
}

.dot{
width:7px;
height:7px;
border-radius:999px;
background:rgba(255,255,255,.25);
cursor:pointer;
}

.dot.active{
background:white;
}

/* EDGE FADES */

.fadeL,.fadeR{
position:absolute;
top:0;
bottom:0;
width:36px;
pointer-events:none;
z-index:4;
}

.fadeL{
left:0;
background:linear-gradient(90deg,#121212,transparent);
}

.fadeR{
right:0;
background:linear-gradient(270deg,#121212,transparent);
}

</style>
</head>

<body>

<div class="wrap">

<div class="title">
5.0 stars on Google — see what others say about us
</div>

<div class="viewport">

<div class="fadeL"></div>
<div class="fadeR"></div>

<div class="controls">
<button class="ctrl" id="prev">←</button>
<button class="ctrl" id="next">→</button>
</div>

<div class="track" id="track"></div>

</div>

<div class="dots" id="dots"></div>

</div>

<script>

const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQZXPZDKBNB9IPq3vZ-6aE6gktPWVuO88xMy2UgCCJ8qbhguOQ0NECV_8tUjzC0uzL2WSX5h6K-CbUQ/pub?gid=0&single=true&output=csv";

const track=document.getElementById("track");
const dots=document.getElementById("dots");

let reviews=[];
let index=0;
let cardWidth=520;
let gap=14;

/* CSV parser */

function parseCSV(text){

const rows=[];
let row=[],cur="",q=false;

for(let i=0;i<text.length;i++){

const c=text[i];
const n=text[i+1];

if(c=='"'&&n=='"'){cur+='"';i++;continue;}
if(c=='"'){q=!q;continue;}

if(c=='\n'&&!q){
row.push(cur);
rows.push(row);
row=[];
cur="";
continue;
}

if(c==','&&!q){
row.push(cur);
cur="";
continue;
}

if(c!='\r')cur+=c;
}

row.push(cur);
rows.push(row);

return rows;

}

/* Load */

async function load(){

const r=await fetch(sheetURL);
const t=await r.text();

const rows=parseCSV(t);

rows.shift();

reviews=rows.map(r=>({

name:r[0],
text:r[1],
rating:r[2],
date:r[3],
source:r[4]

}));

build();

}

/* Build */

function build(){

track.innerHTML=reviews.map(r=>`

<div class="card">

<div class="stars">
${"★★★★★".slice(0,r.rating)}
</div>

<p class="quote">${r.text}</p>

<button class="readmore">
Read more
</button>

<div class="meta">

<div class="name">
${r.name}
</div>

<div>
${r.source} ${r.date}
</div>

</div>

</div>

`).join("");

measureClamp();

buildDots();

}

/* Clamp detection */

function measureClamp(){

document.querySelectorAll(".card").forEach(card=>{

const q=card.querySelector(".quote");
const btn=card.querySelector(".readmore");

if(q.scrollHeight>q.clientHeight+2){

q.classList.add("clamped");
btn.style.display="inline";

}else{

q.classList.remove("clamped");
btn.style.display="none";

}

});

}

/* Read more */

track.addEventListener("click",e=>{

if(!e.target.classList.contains("readmore"))return;

const card=e.target.closest(".card");

card.classList.toggle("expanded");

e.target.innerText=
card.classList.contains("expanded")
?"Read less"
:"Read more";

});

/* Dots */

function buildDots(){

dots.innerHTML=reviews.map((_,i)=>

`<div class="dot ${i==0?"active":""}" data-i="${i}"></div>`

).join("");

dots.onclick=e=>{

if(!e.target.dataset.i)return;

goTo(e.target.dataset.i);

};

}

/* Carousel */

function goTo(i){

index=i;

track.style.transition="transform .5s";

track.style.transform=
`translateX(-${i*(cardWidth+gap)}px)`;

document.querySelectorAll(".dot")
.forEach((d,n)=>d.classList.toggle("active",n==i));

}

/* Controls */

next.onclick=()=>{

index=(index+1)%reviews.length;

goTo(index);

};

prev.onclick=()=>{

index=(index-1+reviews.length)%reviews.length;

goTo(index);

};

/* Auto */

setInterval(()=>{

index=(index+1)%reviews.length;

goTo(index);

},6500);


load();

</script>

</body>
</html>
